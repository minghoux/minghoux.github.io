<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Google sheet experiment</title>
</head>
<body>

<h1>Getting data from google sheet</h1>
<p class="content">Content goes here</p>

<!-- <script>
const sheet = "https://spreadsheets.google.com/feeds/list/";
const sheetId = "1f_OZySGN4ykBR8h4diRhCNEhbIZ3IydfDEf9IzuEYTM";
const getjson = "/od6/public/values?alt=json";
      
const api = sheet + sheetId + getjson;

fetch(api)
  .then(res => res.json())
  .then(data => {
    // console.log(data.feed.entry);
    printData(data.feed.entry);
  })


const printData = (data) => {
  data.map( (data, i) => {
    const message = "User #" + i + " : " + 
                  data.gsx$name.$t + ", " + 
                  data.gsx$age.$t + ", " + 
                  data.gsx$title.$t
    writeData(message);
  })
}

const writeData = (data) => {
  const newContent = document.createElement("div");
  newContent.innerText = data;
  document.body.appendChild(newContent);
}
</script> -->

<!-- google sheet v4 -->
<script>
const gsheet = "https://sheets.googleapis.com/v4/spreadsheets/";
const sheetId = "1f_OZySGN4ykBR8h4diRhCNEhbIZ3IydfDEf9IzuEYTM";
const apikey = "AIzaSyDeMhboTQQwXJ-XkJ8AcCiQ7NB4TARFsf4";
const dataRange = "Sheet1"

const api = gsheet + sheetId + "/values/" + dataRange + "?key=" + apikey

fetch(api)
  .then(res => res.json())
  .then(data => {
    // console.log(data);
    printData(data.values);
  })

const printData = (data) => {
  data.map( (item, i) => {
    let message = "User #" + i + " : " + 
                  item[0] + ", " + 
                  item[1] + ", " + 
                  item[2]
    writeData(message);
  })
}

const writeData = (message) => {
  const newContent = document.createElement("div");
  newContent.innerText = message;
  document.body.appendChild(newContent);
}
</script>
</body>
</html>